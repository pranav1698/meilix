language: generic
include:
- os: linux
  addons:
    apt:
      update: true
      sources:
      - ubuntu-toolchain-r-test
      packages:
      - debootstrap
      - genisoimage
      - p7zip-full
      - squashfs-tools
      - ubuntu-dev-tools
      - dpkg-dev
      - debhelper
      - fakeroot
      - devscripts
      - plymouth-label
      - plymouth-themes
sudo: required
dist: xenial
git:
  depth: 22
script:
  - export LC_ALL=en_US.UTF-8
  - export LANG=en_US.UTF-8
  - export LANGUAGE=en_US.UTF-8
  - chmod +x ./build.sh
  - ./build.sh |& tee home/travis/log.txt

before_deploy:
- export image_name="`echo *.iso`"
- cat *.iso > "/home/travis/${image_name}"
notifications:
  slack: fossasia:3pMkQrSogvEMfnu9aJDW2ZYC
deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: Sw8iM/tB5jej+GLEkFb89g/aRRs/hDPSBByu0VzMnJLCXw7/RgeqyakkORMXD5EL+fOmm+cdMVWZqRWV8wgnPwlRBFzNgRJSYYVMhb3PbZTdP4GcF/lz0TB/HDwNvm5t36qi90X5NpxeziJ3quIgdb9bZ/Cq6F2jqUZMelQsERH++aEyYHMpTkBWPFKvjFeoF08zuFB8nXXkamiJW4Yes+3/j046IntXZZguL3I5BhYnBTWmF0b2rKhc00+JsvODvg27tmI5HlscxrxUhBPopCRv83LxaLBk08WxAV4u94rxJyLTpOMOEWzx427qdnmPU0KXo1JrnIXqh4bcmTew9AmsYZi4qPJAX0VJjy3ZqUwQMxtqUF2V+EAYC6ksJz0WuiFeFNjKzfAeUOYQu0nmcQ0qzyyOHBjxdg/QPVumYVUtMY+zbkKc4IOudDIUnI5VWIidpjHJaEPbEyONOAloYw+aaCQv0G0n6C1tM7UlmFHQeViFLkInjYshdoO5ocXdaZvwDBUiljuHDDkgufqctWrudyBmjwyQBRCY7xekp4tNuwVUiljV7VDSoUIjXdSqoo7oLvy6QB5tu8voj8kdysXmsCgLosFTTvpNhiU9ZicDHoF9u87g1AX0g7mJpBqhiStMwV2B3uZU0h362dsfh7USrQbIkMLJc6VmqPJW7rM=
  file_glob: true # http://stackoverflow.com/a/28579635/1320237
  file: "/home/travis/${image_name}"
  on:
    all_branches: true
    
